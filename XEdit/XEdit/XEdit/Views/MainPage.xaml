<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:skia="clr-namespace:SkiaSharp.Views.Forms;assembly=SkiaSharp.Views.Forms"
             x:Class="XEdit.Views.MainPage" >

    <ContentPage.Resources>
        <Style TargetType="Grid" x:Key="activeItemStyle">
            <Setter Property="VisualStateManager.VisualStateGroups">
                <VisualStateGroupList>
                    <VisualStateGroup x:Name="CommonStates">
                        <VisualState x:Name="Normal" />
                        <VisualState x:Name="Selected">
                            <VisualState.Setters>
                                <Setter Property="BackgroundColor" 
                                        Value="Orange" />
                            </VisualState.Setters>
                        </VisualState>
                    </VisualStateGroup>
                </VisualStateGroupList>
            </Setter>
        </Style>
    </ContentPage.Resources>

    <ContentPage.Content>
        <Grid RowSpacing="0" ColumnSpacing="0" BackgroundColor="Black" >
            
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="10*" />
                <RowDefinition Height="0.3*" />
                <RowDefinition Height="2*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="45" /> <!--DEBUG ONLY-->
            </Grid.RowDefinitions>

            <!--Header-->

            <Grid Grid.Row="0" 
                  BackgroundColor="Navy"
                  HorizontalOptions="Fill"
                  VerticalOptions="Fill" 
                  ColumnSpacing="0" 
                  RowSpacing="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="7*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!--HeightRequest="20" 
                 WidthRequest="25"-->

                <ImageButton BackgroundColor="Red"
                    Padding="5"                                         
                    Source="menu_list.png"
                    HorizontalOptions="Fill"
                    VerticalOptions="Fill"                                    
                    Command="{Binding ImageLoader.SelectCommand }"
                    CommandParameter="{Reference skiaWrapper}">
                </ImageButton>

                <ImageButton BackgroundColor="Brown"
                        Grid.Column="2"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill"       
                        Padding="5"                                         
                        Source="arrow_left.png">
                </ImageButton>
                <ImageButton BackgroundColor="Red"
                        Grid.Column="3"
                        Padding="5"                                         
                        VerticalOptions="Fill" 
                        HorizontalOptions="Fill"
                        Source="arrow_right.png">
                </ImageButton>

            </Grid>
          
            <Grid Grid.Row="1" x:Name="skiaWrapper" 
                  HorizontalOptions="Fill" 
                  VerticalOptions="Fill"
                  BackgroundColor="Black">
                <!--<skia:SKCanvasView x:Name="viewContainer"></skia:SKCanvasView>-->
            </Grid>

            <Slider Grid.Row="2"
                    HorizontalOptions="Fill"
                    MinimumTrackColor="CadetBlue"
                    MaximumTrackColor="Red"
                    BackgroundColor="Black"
                    ThumbColor="White"></Slider>

            <!--tools & filters-->
            <StackLayout Grid.Row="3" >
                <CollectionView ItemsSource="{Binding SelectedSection.Handlers}"
                        ItemsLayout="{x:Static ListItemsLayout.HorizontalList}"
                        SelectionMode="Single" 
                        SelectedItem="{Binding SelectedSection.SelectedHandler, Mode=TwoWay}"  
                        x:Name="filtersTag" >
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Style="{StaticResource activeItemStyle}" WidthRequest="90">
                                <Label                                     
                                    Text="{Binding Name}"
                                    TextColor="White" 
                                    FontSize="Micro" 
                                    HorizontalOptions="CenterAndExpand"
                                    VerticalOptions="CenterAndExpand" >
                                    <!--<Label.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding ButtonCommand}"    
                                                              CommandParameter="{Reference skiaWrapper}"
                                                              NumberOfTapsRequired="1" />
                                    </Label.GestureRecognizers>-->
                                </Label>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </StackLayout>

            <!--sections-->
            <StackLayout Grid.Row="4" >                   
                <CollectionView ItemsSource="{Binding Sections}"
                        ItemsLayout="{x:Static ListItemsLayout.HorizontalList}"
                        SelectionMode="Single" 
                        SelectedItem="{Binding SelectedSection, Mode=TwoWay}"
                        >
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Style="{StaticResource activeItemStyle}" WidthRequest="70">
                                <Label                                     
                                    Text="{Binding Name}"
                                    TextColor="White" 
                                    FontSize="Micro"                                 
                                    HorizontalOptions="CenterAndExpand"
                                    VerticalOptions="CenterAndExpand" >
                                    <!--<Label.GestureRecognizers>
                                        <TapGestureRecognizer Command="{Binding ButtonCommand}"    
                                                              CommandParameter="{Reference skiaWrapper}"
                                                              NumberOfTapsRequired="1" />
                                    </Label.GestureRecognizers>-->
                                </Label>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </StackLayout>

            <Grid Grid.Row="5" VerticalOptions="Fill" HorizontalOptions="Fill">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                    <ColumnDefinition Width="*"></ColumnDefinition>
                </Grid.ColumnDefinitions>
                                           
                <Button  Grid.Column="1"   
                Text="Apply"
                FontSize="Micro" 
                HorizontalOptions="Fill"
                VerticalOptions="Fill" 
                TextColor="Black"
                Command="{Binding ApplyCommand}"
                CommandParameter="{Reference skiaWrapper}" >
                </Button>
            </Grid>
            
        </Grid>
    </ContentPage.Content>
</ContentPage>